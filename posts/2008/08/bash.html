<html><body><div dir="ltr" style="text-align: left;"><h2>История и bang-bang</h2><br>История команд - очень удобный инструмент. С помощью стрелок вверх-вниз можно перемещаться по истории введенных команд. Кроме того, с помощью команды history можно просмотреть всю историю команд:<br><br><pre class="brush: bash">190  ps axu | grep htt<br>  191  /www/bin/apachectl start<br>  192  vi /usr/local/lib/php.ini <br>  193  cat /www/logs/error_log <br>  194  ps -auxw | grep http<br>  195  pwd<br></pre><br>Ничего удивительного.<br>Гораздо интереснее то, что называется bang-bang, или команда !!. `!!` означает последнюю команду в истории. Т.е. ввод !! в данном случае аналогичен pwd.<br>Но и это еще не все. Можно ввести `!&lt;первые буквы команды&gt;`. `!ps` вызовет `ps axu | grep htt`. Но будьте внимательны и сообщайте восклицательному знаку достаточно символов команды. Например !p в данном случае будет аналогично `pwd`, а не `ps axu | grep htt` (поскольку pwd ниже в истории) как возможно хотелось бы.<br><br><a name="more"></a><br><br><h2>:p не просто смайлик</h2><br>Для того чтобы избежать конфузов при использовании ! можно добавлять к нему смайлик :p. Это заставит bash вывести то, что он собирался выполнить. Кроме того, :p достаточно умен для того, чтобы добавить выведенную команду в историю.<br><br>В качестве примера:<br>!ps:p в нашем случае вернет "ps axu | grep htt". Убедившись что это именно то что нужно, можно ввести !! и bash выполнит `ps axu | grep htt`.<br><br><h2>Другие способы использования истории</h2><br>Наверное самый примитивный способ - вызвать команду history, узнав номер необходимой команды, а затем использовать !N, где N - номер команды в истории (например, !192). Не следует пренебрегать этой возможностью. Иногда запомнить !123 для какой-то постоянно нужной команды гораздо проще чем пользоваться другими способами.<br>Кстати, :p работает и тут.<br><br>Еще один удобный способ - нажать ^r (Ctrl-r) и начать вводить первые символы нужной команды. bash будет искать в истории подходящие команды.<br><br><h2>Работа с аргументами</h2><br>!$ (bang-dollar) означает последний аргумент последней команды.<br>К примеру тут:<br><pre class="brush: bash">ls /some/long/path/to/dir/<br>rm -rf !$<br></pre>!$ превратится в /some/long/path/to/dir/.<br><br>Кстати, :p тут тоже работает.<br><br>!* похожа на !$. !* превращается во все аргументы последней команды.<br><br><h2>Шапочки</h2><br>Наверняка вы не раз вводили что-то типа<br><pre class="brush: bash">vi /etc/X22/xorg.conf<br></pre>Это очень легко поправить с помощью шляпок:<br>^22^11 заменяет 22 на 11 в предыдущей команде. По аналогии всегда можно использовать ^ошибка^исправление.<br><br><h2>Автодополнение</h2><br>Ну и разумеется не стоит забывать про автодополнение. Один Tab дополняет команду насколько можно понять, второй выводит все варианты дальнейшего написания. Однако не следует этим злоупотреблять. Согласитесь, написать less быстрее, чем написать le и долбить по табу.<br><br><h2>Алиасы</h2><br>Полезно дать короткие имена часто используемым командам. Также полезно дать алиасы наиболее частым опечаткам.<br>Полезными алиасами могут быть:<br><pre class="brush: bash">alias ls='ls --color=auto'<br>alias mroe='more'<br>alias H='kill -HUP'<br>alias ssh-production='ssh www.myproject.com'<br>alias ssh-qa='ssh qa.myproject.com'<br>alias sl='ls'<br></pre><br>© <a href="http://www.deadman.org/bash.html">Deadman.org</a></div></body></html>